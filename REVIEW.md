# Отчет по лабораторной работе: Настройка сетевого взаимодействия между виртуальными машинами

## Описание лабораторной работы

Цель лабораторной работы - настроить три виртуальные машины с Ubuntu, настроить сетевой доступ между ними и продемонстрировать успешную настройку в терминале с помощью различных команд.

## Используемые инструменты

- Виртуальные машины, запущенные в Parallels
- Сетевой интерфейс: Bridged (по Wi-Fi)

## Шаг 1: Настройка виртуальной машины А (Ubuntu)

1. Для начала были установлены виртуальные машины А, Б, В с операционной системой Ubuntu в Parallels.
2. Для подключения к сети на каждой машине был настроен сетевой интерфейс в режиме Bridged, чтобы обеспечить прямой доступ в Интернет через Wi-Fi.
3. Проверка доступности веб-страницы с помощью `wget --spider`

Для проверки доступности веб-страницы, не скачивая её содержимое, была использована команда:

  ```bash
    wget --spider google.com
  ```

**Объяснение команды:**
- `wget` — утилита для скачивания файлов по сети, поддерживающая работу с HTTP, HTTPS и FTP.  
- `--spider` — опция, которая активирует режим “паучка”, где wget проверяет, существует ли удалённый файл, но не скачивает его содержимое.  
- `google.com` — URL-адрес, который проверяется на доступность.

**Ответ на команду**
- `Spider mode enabled. Check if remote file exists.` - включен режим “паука”, который проверяет, существует ли удалённый файл по указанному адресу.
- `Resolving google.com (google.com)… 173.194.222.100, 173.194.222.113, 173.194.222.139, …` - команда выполняет DNS-разрешение для домена google.com, получая несколько IP-адресов для подключения.
- `Connecting to google.com (google.com)|173.194.222.100|:80… connected.` - установлено соединение с сервером Google на IP-адресе 173.194.222.100 на стандартном порту HTTP (80).
- `HTTP request sent, awaiting response… 301 Moved Permanently Location: http://www.google.com/ [following]` - ответ от сервера: код 301, означающий, что страница была перемещена на новый URL (www.google.com). wget автоматически переходит на новый адрес.
- `Resolving www.google.com (www.google.com)… 74.125.131.104, 74.125.131.99, 74.125.131.106, …` - выполняется разрешение домена для нового адреса www.google.com.
- `Connecting to www.google.com (www.google.com)|74.125.131.104|:80… connected.` - установлено соединение с сервером www.google.com на порту 80.
- `HTTP request sent, awaiting response… 200 OK` - сервер успешно отвечает с кодом 200, что подтверждает успешный запрос и доступность ресурса.
- `Length: unspecified [text/html]` - размер ресурса не указан, однако контент страницы представляет собой HTML-документ.
- `Remote file exists and could contain further links, but recursion is disabled – not retrieving.` - ресурс существует и может содержать дополнительные ссылки, но рекурсия отключена, поэтому wget не будет скачивать эти ссылки.

**Результат выполнения:**

Команда показала, что сайт google.com доступен и был успешно перенаправлен на www.google.com. Ресурс был найден, но его содержимое не было загружено, поскольку была отключена рекурсия.
  
**Скриншот из терминала:**

## Шаг 2: Получение ip каждой машины 

1. Для получения информации о сетевых интерфейсах и их статусе была использована команда:

  ```bash
    ip a
  ```

**Объяснение команды:**
- `ip` — утилита для управления сетевыми настройками в Linux. Она заменяет старую команду ifconfig.  
- `a` — параметр, который позволяет отобразить все сетевые интерфейсы и их настройки (аналогично команде ifconfig).

  Ответ на команду:
  
  В результате выполнения команды выводятся все сетевые интерфейсы на машине с их IP-адресами и статусами. Рассмотрим ключевые строки из вывода:
  	1.	“link/ether 00:1C:42:50:14:10 brd ff:ff:ff:ff:ff:ff”
  	  •	Эта строка указывает на MAC-адрес интерфейса. В данном случае это пустое значение, так как интерфейс может быть не активирован.
  	2.	“inet 192.168.68.104/22 brd 192.168.71.255 scope global dynamic noprefixroute enp0s3”
    	•	Эта строка указывает на IP-адрес интерфейса (192.168.68.104) с маской подсети /22, что означает, что адрес принадлежит подсети 192.168.68.0.
    	•	scope global говорит о том, что IP-адрес является глобальным (может быть использован для маршрутизации).
    	•	dynamic указывает на то, что адрес был получен динамически (например, через DHCP).
    	•	enp0s3 — это имя сетевого интерфейса.
  	3.	“inet6 fe80::9b21:6093:aa03:f8ce/64 scope link”
    	•	Это строка для IPv6-адреса. Здесь указан локальный адрес (fe80::), который используется для связи в пределах локальной сети.
    	•	scope link указывает, что этот адрес используется только для связи внутри сети (не маршрутизируемый глобально).
  	4.	“state UP”
  	  •	Это указывает на состояние интерфейса. UP означает, что интерфейс активен и работает. Если интерфейс был бы в состоянии DOWN, это означало бы, что он не активен.
  	5.	“valid_lft forever preferred_lft forever”
  	  •	Это информация о времени жизни (TTL) для IPv6-адреса. valid_lft forever и preferred_lft forever означают, что адрес действителен и предпочтителен навсегда (для статических адресов).

  Результат выполнения:
  
  Команда ip a позволяет увидеть всю информацию о сетевых интерфейсах на машине, включая их IP-адреса, MAC-адреса и состояние. Это полезно для диагностики сетевых подключений и управления сетевыми интерфейсами.

  Скриншот из терминала:

## Шаг 3: Блокировка машины В на машине Б

1. Блокирование сетевого взаимодействия с машиной В была проведена с помощью команды:

   ```bash
    sudo iptables -A INPUT -s 192.168.68.104 -j DROP
    ```
   
**Объяснение команды:**
- `sudo` — команда выполняется с правами администратора, что необходимо для изменения настроек брандмауэра.
- `iptables` — утилита для настройки фильтрации трафика в Linux.
- `-A INPUT` - добавление правила в цепочку INPUT, которая управляет входящим трафиком на текущую машину.
- `-s 192.168.68.104` - указывает, что правило применяется к трафику, поступающему с IP-адреса 192.168.68.104 (это IP-адрес машины В).
- `-j DROP` - данный флаг указывает, что пакеты с указанного IP-адреса должны быть отброшены, т.е. доступ из машины В (с IP-адресом 192.168.68.104) в машину Б блокируется.

**Результат выполнения команды:**

  После выполнения этой команды на машине Б был заблокирован доступ с машины В. Таким образом, машина В не могла отправлять пакеты на машину Б, что подтверждается отсутствием пинга из машины В в машину Б.

**Скриншот из терминала:**

## Шаг 4: Проверка сетевого взаимодействия

1. Проверка доступа из машины А в машину Б, из машины А в машину В, из машины В в машину Б:

    ```bash
    ping 192.168.68.106
    ping 192.168.68.104
    ```
**Объяснение команды:**
- `ping` — утилита для проверки доступности удалённого хоста в сети. Она отправляет ICMP-запросы и ожидает ответ, что позволяет убедиться в наличии сетевого соединения.
- `192.168.68.104` — IP-адрес машины, с которой проверяется соединение. В данном случае это адрес одной из виртуальных машин.

    Успешный ответ на команду:
    	1.	“64 bytes from 192.168.68.104: icmp_seq=1 ttl=64 time=0.226 ms”
    	  •	Это строка для первого ответа от машины с IP-адресом 192.168.68.104. Указан размер пакета (64 байта), номер пакета ICMP (icmp_seq=1), время жизни пакета (TTL=64) и время отклика (0.226 мс).
    	2.	“64 bytes from 192.168.68.104: icmp_seq=2 ttl=64 time=0.347 ms”
    	  •	Следующий ответ с машиной 192.168.68.104 с временем отклика 0.347 мс.
    	3.	”— 192.168.68.104 ping statistics —”
    	  •	В конце команды выводится статистика пинга: количество отправленных пакетов, полученных ответов и процент потерь пакетов.
    	4.	“11 packets transmitted, 11 received, 0% packet loss, time 7156 ms”
    	  •	Всего было отправлено 11 пакетов, из которых все были получены, без потерь пакетов (0%). Время, затраченное на передачу и получение, составило 7156 мс.
    	5.	“rtt min/avg/max/mdev = 0.226/0.307/0.488/0.068 ms”
    	  •	Статистика времени отклика (round-trip time, RTT): минимальное, среднее и максимальное время отклика (в миллисекундах), а также стандартное отклонение (mdev).
   
    Неуспешный ответ на команду:
     	1.	“64 bytes from 192.168.68.106: icmp_seq=1 ttl=64 time=…”
	      •	Ожидаемый ответ с указанием времени отклика и других данных. Однако в данном случае мы видим, что все попытки пинга заканчиваются без получения ответа.
	    2.	”— 192.168.68.106 ping statistics —”
	      •	В конце выводится статистика пинга, показывающая количество переданных и полученных пакетов, а также процент потерь.
	    3.	“9 packets transmitted, 0 received, 100% packet loss, time 8173ms”
	      •	Все отправленные пакеты не были получены, что означает 100% потерю пакетов. Это указывает на отсутствие сетевого соединения с машиной 192.168.68.106. Время задержки составило 8173 мс, что может указывать на проблему с сетью или настройки маршрутизации.
   
    Скриншот из терминала:

## Заключение

В результате лабораторной работы были выполнены все необходимые шаги для настройки сетевого взаимодействия между тремя виртуальными машинами. Мы обеспечили доступ между машинами А и Б, а также между машинами А и В, но ограничили доступ из машины B в машину Б с помощью правил файрвола.

Отчет и скриншоты подтверждают успешное выполнение задания.
